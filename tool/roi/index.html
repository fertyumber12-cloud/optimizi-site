<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Endüstriyel İzolasyon Yatırımı Amortisman Hesaplama</title>
    <meta name="description" content="ISO 12241 standardına göre boru, vana ve tank yüzeylerinden ısı kaybını hesaplayın.">
    <link rel="icon" type="image/png" href="favicon.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script>
      tailwind.config = {
        theme: {
          fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] },
          extend: { colors: { slate: { 850: '#151e2e', 900: '#0f172a', 950: '#020617' } } }
        }
      }
    </script>

    <link rel="stylesheet" href="css/style.css">
</head>
<body class="antialiased selection:bg-indigo-500/30 selection:text-indigo-400" onload="initApp()">

<div id="app-layer" class="relative z-10 flex flex-col min-h-screen">
    <nav class="sticky top-0 z-50 glass-card !bg-white/90 !border-x-0 !border-t-0 !rounded-none border-b border-slate-200 backdrop-blur-xl">
      <div class="app-container px-6 h-16 flex items-center justify-between">
          <a href="#" class="flex items-center gap-3 group">
              <div><h1 class="text-lg font-bold text-slate-800 tracking-wide">Optimizi<span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 to-orange-500">.App</span></h1></div>
          </a>
          <div class="flex items-center gap-3">
              <div class="hidden md:flex items-center gap-2 px-3 py-1.5 rounded-full bg-slate-100 border border-slate-200 text-xs text-slate-500">
                  <span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span>
                  <span id="fxVal" class="font-bold text-slate-800">...</span> <span class="text-[10px] opacity-70">TL/USD</span>
                  <button onclick="getFx()"><i data-lucide="refresh-cw" class="w-3 h-3 ml-1 hover:animate-spin text-slate-400 hover:text-indigo-500 cursor-pointer"></i></button>
              </div>
              <label class="flex items-center gap-2 cursor-pointer bg-slate-100 px-3 py-1.5 rounded-lg border border-slate-200 hover:border-green-500 transition select-none">
                  <i data-lucide="qr-code" class="w-4 h-4 text-slate-500"></i>
                  <span class="text-[10px] font-bold text-slate-500">QR Göster</span>
                  <input type="checkbox" id="toggleQrInput" checked class="w-4 h-4 accent-green-500 cursor-pointer" onchange="toggleQrVisibility()">
              </label>
              <button onclick="printRep()" class="flex items-center gap-2 bg-indigo-600 hover:bg-indigo-500 text-white px-4 py-2 rounded-lg text-xs font-bold transition shadow-lg shadow-indigo-600/20 active:scale-95 ml-2 cursor-pointer">
                  <i data-lucide="printer" class="w-4 h-4"></i> Rapor Al
              </button>
          </div>
      </div>
    </nav>

    <main class="flex-1 app-container p-6 lg:p-8">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="glass-card p-6 relative overflow-hidden group rounded-2xl">
               <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition transform group-hover:scale-110"><i data-lucide="timer" class="w-24 h-24 text-indigo-500"></i></div>
               <div class="text-slate-500 text-[10px] font-bold uppercase tracking-wider mb-2">Ort. Amortisman</div>
               <div class="text-4xl font-bold text-slate-800 tracking-tight" id="dashRoi">---</div>
               <div class="mt-4 h-1 w-full bg-slate-200 rounded-full overflow-hidden"><div id="barRoi" class="h-full bg-indigo-500 w-0 transition-all duration-1000 shadow-[0_0_10px_rgba(99,102,241,0.5)]"></div></div>
            </div>
            <div class="glass-card p-6 relative overflow-hidden group rounded-2xl">
               <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition"><i data-lucide="wallet" class="w-24 h-24 text-green-500"></i></div>
               <div class="text-slate-500 text-[10px] font-bold uppercase tracking-wider mb-2">Yıllık Kazanç</div>
               <div class="text-3xl font-bold text-green-600 tracking-tight" id="dashSave">0</div>
            </div>
            <div class="glass-card p-6 relative overflow-hidden rounded-2xl">
               <div class="text-slate-500 text-[10px] font-bold uppercase tracking-wider mb-2">Toplam Yatırım</div>
               <div class="text-3xl font-bold text-slate-800 tracking-tight" id="dashInv">0</div>
            </div>
            <div class="glass-card p-6 !bg-gradient-to-br from-slate-100 to-slate-200 border-orange-500/20 rounded-2xl">
               <div class="flex items-center justify-between">
                  <div>
                      <div class="text-orange-500 text-[10px] font-bold uppercase tracking-wider mb-1">CO2 Azaltım</div>
                      <div class="text-3xl font-bold text-slate-800" id="dashCo2">0 <span class="text-sm font-normal text-slate-500">Ton</span></div>
                  </div>
                  <div class="p-3 bg-orange-500/10 rounded-xl text-orange-600 border border-orange-500/20"><i data-lucide="leaf" class="w-6 h-6"></i></div>
               </div>
            </div>
        </div>

        <div class="grid grid-cols-1 xl:grid-cols-12 gap-8 items-start">
            <div class="xl:col-span-3 space-y-6">
                <div class="glass-card p-6 rounded-2xl">
                   <h3 class="text-indigo-500 text-xs font-bold uppercase mb-4 flex items-center gap-2"><i data-lucide="briefcase" class="w-4 h-4"></i> Proje Detayları</h3>
                   <div class="space-y-4">
                       <div><label class="text-[10px] uppercase text-slate-500 font-bold mb-1 block">Hazırlayan</label><div class="grid gap-2"><input type="text" id="pName" class="glass-input text-xs" placeholder="Firma Adı"><input type="text" id="pEng" class="glass-input text-xs" placeholder="Mühendis Adı"></div></div>
                       <div><label class="text-[10px] uppercase text-slate-500 font-bold mb-1 block">Saha Denetim Tarihi</label><input type="date" id="auditDate" class="glass-input text-xs text-slate-600"></div>
                       <div class="h-px bg-slate-200 my-3"></div>
                       <div><label class="text-[10px] uppercase text-slate-500 font-bold mb-1 block">Firma Bilgileri</label><div class="grid gap-2"><input type="text" id="cName" class="glass-input text-xs" placeholder="Firma Adı"><input type="text" id="cEng" class="glass-input text-xs" placeholder="Yetkili Kişi / Ünvan"></div></div>
                   </div>
                </div>

                <div class="glass-card p-6 rounded-2xl">
                    <h3 class="text-orange-500 text-xs font-bold uppercase mb-4 flex items-center gap-2"><i data-lucide="flame" class="w-4 h-4"></i> Ortam & Enerji</h3>
                    <div class="grid grid-cols-2 gap-4">
                        <div><label class="text-[10px] text-slate-500 mb-1 block">Ortam Sıc. (°C)</label><input type="number" id="tAmb" class="glass-input text-xs" value="25"></div>
                        <div><label class="text-[10px] text-slate-500 mb-1 block">Rüzgar (m/s)</label><input type="number" id="vWind" class="glass-input text-xs" value="0" step="0.5"></div>
                    </div>
                    
                    <div class="mt-4">
                        <label class="text-[10px] text-slate-500 mb-1 block">Yakıt Tipi</label>
                        <select id="fuel" onchange="toggleFuelMode()" class="glass-input text-xs">
                             <option value="gas">Doğalgaz (8250 kcal/m³)</option>
                             <option value="elec">Elektrik (860 kcal/kWh)</option>
                             <option value="lng">LNG (11500 kcal/kg)</option>
                             <option value="fueloil">Fuel Oil (9600 kcal/kg)</option>
                             <option value="coal_imp">İthal Kömür (6000 kcal/kg)</option>
                             <option value="coal_loc">Yerli Kömür (3500 kcal/kg)</option>
                             <option value="manual" class="font-bold text-indigo-500">⚡ Manuel Giriş</option>
                        </select>
                    </div>

                    <div id="manualFuelBox" class="hidden mt-3 p-3 rounded-lg bg-slate-50 border border-slate-200">
                         <div class="grid grid-cols-2 gap-3">
                             <div><label class="text-[9px] text-indigo-500 font-bold mb-1 block">LHV (kcal)</label><input type="number" id="fuelLhv" class="glass-input text-xs" placeholder="Örn: 8250"></div>
                             <div><label class="text-[9px] text-indigo-500 font-bold mb-1 block">Birim</label><select id="fuelUnit" class="glass-input text-xs"><option value="m3">kcal/m³</option><option value="kg">kcal/kg</option><option value="kwh">kcal/kWh</option></select></div>
                         </div>
                    </div>
                    
                    <div class="mt-4"><label class="text-[10px] text-slate-500 mb-1 block">Kazan Verimi %</label><input type="number" id="eff" class="glass-input text-center text-xs" value="85"></div>
                    <div class="grid grid-cols-2 gap-4 mt-4">
                        <div><label class="text-[10px] text-slate-500 mb-1 block">Birim Fiyat</label><div class="flex gap-1"><input type="number" id="price" class="glass-input text-xs" value="0.15"><select id="energyCurr" class="glass-input !px-1 w-14 text-center text-xs"><option value="TL" selected>₺</option><option value="USD">$</option><option value="EUR">€</option></select></div></div>
                        <div><label class="text-[10px] text-slate-500 mb-1 block">Yıllık Saat</label><input type="number" id="hours" class="glass-input text-xs" value="8000"></div>
                    </div>
                </div>

                <div id="packagePanel" class="hidden glass-card p-6 rounded-2xl border-2 border-indigo-500/50 bg-indigo-50/50">
                    <div class="flex justify-between items-start mb-4">
                         <h3 class="text-indigo-600 text-sm font-bold uppercase flex items-center gap-2"><i data-lucide="package" class="w-5 h-5"></i> Paket Oluşturucu</h3>
                         <div class="bg-indigo-200 text-indigo-700 text-[10px] font-bold px-2 py-1 rounded">MOD AKTİF</div>
                    </div>
                    <div class="space-y-3">
                        <div class="bg-white rounded-lg p-3 max-h-40 overflow-y-auto border border-slate-200"><ul id="pkgList" class="space-y-2 text-xs"><li class="text-slate-400 text-center italic py-2">Henüz sepete ürün eklenmedi.</li></ul></div>
                        <div class="grid grid-cols-2 gap-2 text-[10px]">
                            <div class="text-slate-500">Sepet Toplamı:</div><div class="text-right font-bold text-slate-800" id="pkgTotalQty">0 Parça</div>
                            <div class="text-slate-500">Potansiyel Kazanç:</div><div class="text-right font-bold text-green-600" id="pkgTotalSave">0 ₺</div>
                        </div>
                        <div class="pt-3 border-t border-indigo-200">
                            <label class="text-[10px] text-indigo-600 font-bold block mb-1">Paket Adı</label><input type="text" id="pkgName" class="glass-input text-xs mb-2" placeholder="Örn: Kazan Dairesi Seti">
                            <div class="grid grid-cols-2 gap-2 mb-2">
                                <div><label class="text-[10px] text-indigo-600 font-bold block mb-1">Paket Adedi</label><input type="number" id="pkgQty" class="glass-input text-center text-xs font-bold" value="1" placeholder="Adet"></div>
                                <div><label class="text-[10px] text-indigo-600 font-bold block mb-1">Paket Foto</label><input type="file" id="pkgImgInp" class="hidden" accept="image/*" onchange="readPkgImg(this)"><button onclick="document.getElementById('pkgImgInp').click()" class="w-full h-[34px] glass-input text-xs flex items-center justify-center gap-2 hover:bg-slate-100 transition"><i data-lucide="camera" class="w-3 h-3"></i> Seç</button></div>
                            </div>
                            <img id="pkgPrevImg" class="hidden w-full h-16 object-cover rounded-lg mb-2 border border-indigo-200">
                            <label class="text-[10px] text-indigo-600 font-bold block mb-1">Paket (Birim) Yatırım Bedeli</label>
                            <div class="flex gap-1 mb-3"><input type="number" id="pkgInv" class="glass-input text-xs" placeholder="Birim Set Tutar"><select id="pkgInvCurr" class="glass-input !px-1 w-14 text-center text-xs"><option value="TL">₺</option><option value="USD">$</option><option value="EUR">€</option></select></div>
                            <button onclick="commitPackage()" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 rounded-lg text-xs shadow transition active:scale-95">Paketi Tamamla & Listeye Ekle</button>
                        </div>
                    </div>
                </div>

                <div class="glass-card p-6 border-indigo-500/30 shadow-[0_0_20px_rgba(99,102,241,0.1)] rounded-2xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-32 h-32 bg-indigo-500/10 rounded-full blur-2xl -mr-16 -mt-16 pointer-events-none"></div>
                    <div class="flex justify-between items-center mb-4 relative z-10">
                        <h3 class="text-slate-800 text-sm font-bold uppercase flex items-center gap-2"><i data-lucide="plus-circle" class="w-4 h-4 text-indigo-500"></i> Yeni Ölçüm Ekle</h3>
                        <button onclick="togglePackageMode()" id="btnTogglePkg" class="text-[10px] bg-slate-200 text-slate-600 px-3 py-1 rounded-full hover:bg-indigo-100 hover:text-indigo-600 transition font-bold flex items-center gap-1"><i data-lucide="box" class="w-3 h-3"></i> Paket Modunu Aç</button>
                    </div>
                    
                    <div class="flex bg-slate-100 rounded-lg p-1 mb-4 border border-slate-200 relative z-10">
                        <button onclick="setType('valve')" id="btn-valve" class="flex-1 py-1.5 text-xs font-medium rounded text-white bg-slate-700 shadow transition-all">Armatür</button>
                        <button onclick="setType('pipe')" id="btn-pipe" class="flex-1 py-1.5 text-xs font-medium rounded text-slate-500 hover:text-slate-900 transition-all">Boru</button>
                        <button onclick="setType('tank')" id="btn-tank" class="flex-1 py-1.5 text-xs font-medium rounded text-slate-500 hover:text-slate-900 transition-all">Tank/Düz</button>
                    </div>
                    <select id="type" class="hidden"><option value="valve">Valve</option><option value="pipe">Pipe</option><option value="tank">Flat</option></select>
                    
                    <div id="g-valve" class="space-y-3 relative z-10">
                        <select id="valveType" class="glass-input text-xs">
                            <optgroup label="Vanalar"><option value="gate">Sürgülü Vana</option><option value="globe">Glob Vana</option><option value="ball">Küresel Vana</option><option value="butterfly">Kelebek Vana</option><option value="check">Çekvalf</option><option value="strainer">Pislik Tutucu</option><option value="separator">Buhar Seperatörü</option></optgroup>
                            <optgroup label="Bağlantı Elemanları"><option value="flange">Flanş Çifti (Takım)</option><option value="elbow">Dirsek (90°)</option></optgroup>
                            <optgroup label="Kondenstoplar"><option value="trap_float">Şamandıralı</option><option value="trap_thermo">Termodinamik</option><option value="trap_bimetal">Bimetalik</option><option value="trap_bucket">Ters Kovalı</option></optgroup>
                        </select>
                        <select id="vDN" class="glass-input text-xs"></select>
                    </div>
                    <div id="g-pipe" class="hidden grid grid-cols-2 gap-3 relative z-10"><select id="pDN" class="glass-input text-xs"></select><input type="number" id="pLen" class="glass-input text-xs" placeholder="Boru Uzunluğu (m)" value="1"></div>
                    <div id="g-tank" class="hidden relative z-10">
                        <div class="bg-slate-50 p-3 rounded-lg border border-slate-200 mb-3">
                            <label class="text-[10px] text-slate-500 mb-2 block font-bold">1. Seçenek: Dikdörtgen Yüzey</label>
                            <div class="flex gap-2 mb-2"><input type="number" id="surfW" class="glass-input text-xs" placeholder="En (cm)"><input type="number" id="surfH" class="glass-input text-xs" placeholder="Boy (cm)"><button onclick="addSurface('rect')" class="bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg px-3 flex items-center justify-center transition"><i data-lucide="plus" class="w-4 h-4"></i></button></div>
                            <label class="text-[10px] text-slate-500 mb-2 block font-bold border-t border-slate-200 pt-2 mt-2">2. Seçenek: Daire Yüzey</label>
                            <div class="flex gap-2 mb-2"><input type="number" id="surfD" class="glass-input text-xs" placeholder="Çap (cm)"><button onclick="addSurface('circle')" class="bg-indigo-500 hover:bg-indigo-600 text-white rounded-lg px-3 flex items-center justify-center transition"><i data-lucide="circle" class="w-4 h-4"></i></button></div>
                            <div id="surfaceList" class="space-y-1 mb-2 max-h-24 overflow-y-auto mt-2"></div>
                            <div class="text-right text-[10px] text-slate-500 border-t border-slate-200 pt-2">Toplam Alan: <span id="totalSurfArea" class="font-bold text-slate-800 text-xs">0.00</span> m²</div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 gap-3 mt-4 relative z-10">
                        <div><label class="text-[10px] text-slate-500 mb-1 block">İşletme Sıc. (°C)</label><div class="relative"><input type="number" id="tProc" class="glass-input pl-8 text-xs" value="160"><i data-lucide="thermometer" class="w-3 h-3 text-red-500 absolute left-2.5 top-2.5"></i></div></div>
                        <div><label id="lblQty" class="text-[10px] text-slate-500 mb-1 block">Adet</label><input type="number" id="qty" class="glass-input text-center font-bold text-xs" value="1"></div>
                    </div>
                    <div class="mt-4 relative z-10"><label class="text-[10px] text-slate-500 mb-1 block">Mahal / Lokasyon</label><input type="text" id="location" class="glass-input text-xs" placeholder="Örn: Kazan Dairesi"></div>
                    
                    <div class="mt-4 relative z-10">
                        <input type="file" id="imgInp" class="hidden" accept="image/*" onchange="readImg(this)">
                        <div onclick="document.getElementById('imgInp').click()" class="border border-dashed border-slate-300 rounded-lg p-3 text-center cursor-pointer hover:border-indigo-500 hover:bg-slate-100 transition group"><i data-lucide="camera" class="w-4 h-4 text-slate-400 mx-auto group-hover:text-indigo-500 mb-1"></i><span class="text-[10px] text-slate-400 block">Termal Foto Seç</span></div>
                        <img id="prevImg" class="hidden w-full h-24 object-cover rounded-lg mt-2 border border-slate-300">
                    </div>

                    <div class="mt-4 relative z-10">
                        <input type="file" id="qrInp" class="hidden" accept="image/*" onchange="readQr(this)">
                        <div onclick="document.getElementById('qrInp').click()" class="border border-dashed border-slate-300 rounded-lg p-3 text-center cursor-pointer hover:border-green-500 hover:bg-slate-100 transition group"><i data-lucide="qr-code" class="w-4 h-4 text-slate-400 mx-auto group-hover:text-green-500 mb-1"></i><span class="text-[10px] text-slate-400 block">Rapor QR'ı Yükle</span></div>
                    </div>

                    <div class="bg-slate-100 rounded-lg p-3 mt-4 border border-slate-200 relative z-10">
                        <label class="text-[10px] text-green-600 font-bold uppercase mb-2 block">İzolasyon Özellikleri</label>
                        <div class="mb-2"><select id="calcStd" class="glass-input text-[10px] !py-1 !h-7 text-slate-500"><option value="iso">ISO 12241 (Standard)</option><option value="astm">ASTM C680 (USA)</option><option value="vdi">VDI 2055 (German)</option></select></div>
                        <div class="text-[9px] text-slate-400 uppercase font-bold mb-1">1. Katman</div>
                        <select id="matSelect" class="glass-input text-xs mb-2">
                            <option value="rockwool">Taş Yünü (Sanayi)</option><option value="glasswool">İğnelenmiş Cam Elyaf</option><option value="rubber">Elastomerik Kauçuk</option><option value="aerogel">Aerogel</option><option value="ceramic">Seramik Yünü</option><option value="bare" class="font-bold text-red-500">⚠️ Yalıtımsız (Çıplak)</option>
                        </select>
                        <div class="grid grid-cols-2 gap-2 mt-2 mb-2">
                            <input type="number" id="thk" class="glass-input text-xs" value="50" placeholder="Kalınlık (mm)">
                            <div id="singleInvBox"><div class="flex gap-1"><input type="number" id="inv" class="glass-input text-xs" placeholder="Yatırım"><select id="invCurr" class="glass-input !px-1 w-14 text-center text-xs"><option value="TL">₺</option><option value="USD">$</option><option value="EUR">€</option></select></div></div>
                        </div>
                        <div class="mt-2 pt-2 border-t border-slate-300">
                            <label class="flex items-center gap-2 cursor-pointer mb-2"><input type="checkbox" id="useL2" onchange="toggleL2()" class="w-3 h-3 rounded border-slate-400 text-indigo-500"><span class="text-[10px] text-slate-500 font-bold">2. Katman Ekle (Kompozit)</span></label>
                            <div id="layer2Box" class="hidden"><select id="matSelect2" class="glass-input text-xs mb-2"><option value="rubber" selected>Elastomerik Kauçuk</option><option value="rockwool">Taş Yünü (Sanayi)</option><option value="glasswool">İğnelenmiş Cam Elyaf</option><option value="aerogel">Aerogel</option><option value="ceramic">Seramik Yünü</option></select><input type="number" id="thk2" class="glass-input text-xs" value="19" placeholder="Kalınlık (mm)"></div>
                        </div>
                        <div class="mt-3 text-right"><label class="text-[9px] text-slate-500 mr-2 uppercase font-bold">Rapor Para Birimi:</label><select id="curr" class="glass-input text-[10px] !w-20 inline-block !py-1 !h-7" onchange="render()"><option value="TL" selected>₺ TL</option><option value="USD">$ USD</option><option value="EUR">€ EUR</option></select></div>
                    </div>

                    <div id="btn-group" class="mt-4 relative z-10">
                        <button id="btnAdd" onclick="calc()" class="w-full bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-3 rounded-xl shadow-lg shadow-indigo-600/20 transition active:scale-95 flex items-center justify-center gap-2 text-sm cursor-pointer"><i data-lucide="plus" class="w-4 h-4"></i> <span id="btnAddText">Hesapla & Ekle</span></button>
                        <button id="btnUpdate" onclick="finishUpdate()" class="hidden w-full bg-orange-500 hover:bg-orange-400 text-white font-bold py-3 rounded-xl shadow-lg shadow-orange-500/20 transition active:scale-95 flex items-center justify-center gap-2 text-sm cursor-pointer"><i data-lucide="check" class="w-4 h-4"></i> Güncellemeyi Bitir</button>
                    </div>
                </div>
            </div>

            <div class="xl:col-span-9">
                <div class="glass-card p-0 overflow-hidden flex flex-col rounded-2xl h-[calc(100vh-100px)]">
                    <div class="p-4 border-b border-slate-200 flex justify-between items-center bg-slate-50 shrink-0">
                        <h3 class="font-bold text-slate-800 flex items-center gap-2"><i data-lucide="list" class="w-4 h-4 text-green-500"></i> Hesaplama Listesi</h3>
                        <div class="flex gap-2">
                             <input type="file" id="csvInput" class="hidden" accept=".csv" onchange="importCSV(this)">
                             <button onclick="document.getElementById('csvInput').click()" class="flex items-center gap-1 text-[10px] bg-emerald-100 hover:bg-emerald-200 text-emerald-700 px-2 py-1 rounded transition cursor-pointer"><i data-lucide="upload" class="w-3 h-3"></i> Excel Yükle</button>
                             <button onclick="exportCSV()" class="flex items-center gap-1 text-[10px] bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-1 rounded transition cursor-pointer"><i data-lucide="download" class="w-3 h-3"></i> Excel İndir</button>
                             <div class="w-px h-4 bg-slate-300 mx-1"></div>
                             <button onclick="clearAll()" class="text-xs text-red-500 hover:text-red-700 transition cursor-pointer">Temizle</button>
                        </div>
                    </div>
                    <div class="overflow-auto flex-1 table-container">
                        <table class="w-full text-left text-sm" id="grid">
                        <thead class="table-sticky-header bg-slate-100 text-[10px] uppercase text-slate-500 font-semibold shadow-sm">
                            <tr>
                            <th class="px-6 py-3">Görsel</th>
                            <th class="px-6 py-3">Ekipman</th>
                            <th class="px-6 py-3">Detay</th>
                            <th class="px-6 py-3 text-center w-24">Miktar</th>
                            <th class="px-6 py-3 text-center text-red-500">Çıplak Yüzey Sıc.<br><span class="text-[9px]">(Kayıp kWh)</span></th>
                            <th class="px-6 py-3 text-center text-orange-500">İzolasyonlu Yüzey Sıc.<br><span class="text-[9px]">(Kayıp kWh)</span></th>
                            <th class="px-6 py-3 text-center text-green-600">Kazanç<br><span class="text-[9px]">(Fark kWh)</span></th>
                            <th class="px-6 py-3 text-right w-32">Yatırım</th><th class="px-6 py-3 text-right text-green-600">Kazanç (Tutar)</th>
                            <th class="px-6 py-3 text-right">ROI</th><th class="px-6 py-3 text-right">İşlem</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-200" id="gridBody">
                            <tr><td colspan="11" class="px-6 py-20 text-center text-slate-500"><i data-lucide="inbox" class="w-12 h-12 mx-auto mb-3 opacity-20"></i><span id="emptyMsg">Henüz hesaplama eklenmedi.</span></td></tr>
                        </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<div id="print-area">
    <div id="p-cover" class="print-page cover-bg relative overflow-hidden flex">
        <div class="w-1/3 bg-slate-900 text-white p-12 flex flex-col justify-between relative overflow-hidden">
            <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"></div>
            <div class="absolute top-0 right-0 w-64 h-64 bg-green-500 rounded-full blur-[100px] opacity-20 -mr-32 -mt-32"></div>
            <div class="relative z-10">
                <div class="text-3xl font-black tracking-tighter mb-1">Optimizi<span class="text-green-500">.App</span></div>
                <div class="text-[10px] uppercase tracking-[4px] text-slate-400">Engineering Solutions</div>
                <div class="mt-20 space-y-8">
                    <div><div class="text-[10px] uppercase text-slate-500 font-bold mb-1">Firma / Müşteri</div><div class="text-2xl font-bold text-white leading-tight" id="covClient">FİRMA ADI</div><div class="text-sm text-slate-400 mt-1" id="covContact">Yetkili Kişi</div></div>
                    <div><div class="text-[10px] uppercase text-slate-500 font-bold mb-1">Tedarikçi / Hazırlayan</div><div class="text-xl font-bold text-white" id="covProv">TEDARİKÇİ</div></div>
                    <div><div class="text-[10px] uppercase text-slate-500 font-bold mb-1">Rapor Tarihi</div><div class="text-xl font-bold text-white font-mono" id="covDate">...</div></div>
                </div>
            </div>
            <div class="relative z-10">
                <div class="p-4 bg-white/5 rounded-xl border border-white/10 backdrop-blur-sm">
                    <img id="covQrCode" src="" class="w-24 h-24 object-contain opacity-50 mb-2 mix-blend-screen" alt="QR">
                    <div class="text-[9px] text-slate-400 leading-tight">Mevcut ısı kayıplarının tesisinize anlık maliyetini takip etmek için kodu taratın.</div>
                </div>
            </div>
        </div>
        <div class="w-2/3 p-12 bg-white flex flex-col relative">
             <div class="absolute top-0 right-0 p-12 opacity-5"><i data-lucide="activity" class="w-64 h-64 text-slate-900"></i></div>
             <div class="flex-1 flex flex-col justify-center relative z-10">
                <div class="inline-block bg-green-100 text-green-700 px-3 py-1 rounded text-[10px] font-bold uppercase tracking-wider w-max mb-4">ISO 12241 Temelli Isı Kaybı Kaynaklı Kayıp Simülasyonu</div>
                <h1 class="text-6xl font-black text-slate-900 leading-none mb-6">ENDÜSTRİYEL <br><span class="text-transparent bg-clip-text bg-gradient-to-r from-green-600 to-emerald-800">YALITIM</span> ANALİZİ</h1>
                <p class="text-sm text-slate-500 leading-relaxed mb-6 max-w-lg text-justify"><span id="covIntroDate" class="font-bold text-slate-900">...</span> tarihinde tesisinizde gerçekleştirilen termal denetimler sonucunda; yalıtımsız ekipmanlardan kaynaklanan ısı kayıpları, finansal maliyetler ve karbon ayak izi hesaplanmıştır. Aşağıdaki veriler mevcut durumun özetidir.</p>
                <div class="flex flex-col gap-3 mb-6">
                    <div class="p-3 bg-slate-50 rounded-xl border border-slate-100 flex items-center justify-between"><div class="text-xs font-bold text-slate-400 uppercase tracking-wide w-24">GÜNLÜK</div><div class="text-xl font-black text-slate-700 text-right flex-1" id="covFuelDay">0</div><div class="text-[10px] text-slate-400 fuel-unit-label ml-2 w-12">...</div><div class="bg-slate-200 rounded px-2 py-1 ml-4 w-24 text-center"><div class="text-[10px] font-bold text-slate-600"><span id="covKwhDay">0</span> kWh</div></div></div>
                    <div class="p-3 bg-slate-50 rounded-xl border border-slate-100 flex items-center justify-between"><div class="text-xs font-bold text-slate-400 uppercase tracking-wide w-24">HAFTALIK</div><div class="text-xl font-black text-slate-700 text-right flex-1" id="covFuelWeek">0</div><div class="text-[10px] text-slate-400 fuel-unit-label ml-2 w-12">...</div><div class="bg-slate-200 rounded px-2 py-1 ml-4 w-24 text-center"><div class="text-[10px] font-bold text-slate-600"><span id="covKwhWeek">0</span> kWh</div></div></div>
                    <div class="p-3 bg-slate-50 rounded-xl border border-slate-100 flex items-center justify-between"><div class="text-xs font-bold text-slate-400 uppercase tracking-wide w-24">AYLIK</div><div class="text-xl font-black text-slate-700 text-right flex-1" id="covFuelMonth">0</div><div class="text-[10px] text-slate-400 fuel-unit-label ml-2 w-12">...</div><div class="bg-slate-200 rounded px-2 py-1 ml-4 w-24 text-center"><div class="text-[10px] font-bold text-slate-600"><span id="covKwhMonth">0</span> kWh</div></div></div>
                    <div class="p-3 bg-red-50 rounded-xl border border-red-100 flex items-center justify-between relative overflow-hidden"><div class="text-xs font-bold text-red-400 uppercase tracking-wide w-24">YILLIK</div><div class="text-2xl font-black text-red-600 text-right flex-1" id="covFuelYear">0</div><div class="text-[10px] text-red-400 fuel-unit-label ml-2 w-12">...</div><div class="bg-red-100 rounded px-2 py-1 ml-4 w-24 text-center"><div class="text-[10px] font-bold text-red-700"><span id="covKwhYear">0</span> kWh</div></div></div>
                </div>
             </div>
             <div class="mt-auto border-t-2 border-slate-900 pt-6 flex justify-between items-end">
                <div class="text-[10px] text-slate-500 w-2/3 leading-relaxed" id="covNarrative">...</div>
                <div class="text-right">
                    <div class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1">Amortisman (ROI)</div>
                    <div class="text-7xl font-black text-slate-900 leading-none" id="covRoiBig">---</div>
                    <div class="text-sm font-bold text-slate-400 mt-1 uppercase">AY</div>
                </div>
             </div>
        </div>
    </div>
    
    <div id="p-table" class="print-page p-12">
        <div class="flex justify-between items-center border-b-2 border-slate-900 pb-4 mb-8"><h2 class="text-xl font-black text-slate-900 uppercase">Detaylı Analiz Dökümü</h2><div class="text-xs text-slate-500" id="rDate">...</div></div>
        <table class="w-full audit-table mb-8"><thead><tr id="rep_table_head"></tr></thead><tbody id="rTable"></tbody></table>
        <div class="page-num mt-auto pt-8 border-t border-slate-200 text-center text-[10px] text-slate-400">Page 2 / 3</div>
    </div>
    
    <div id="p-summary" class="print-page p-12 flex flex-col h-full">
        <h2 class="text-2xl font-black text-slate-900 uppercase mb-8 border-b-2 border-slate-900 pb-4">Yönetici Özeti</h2>
        <div class="flex flex-col mb-12">
            <div class="py-6 border-b border-slate-200 flex justify-between items-center group"><div><div class="text-sm text-red-500 font-bold uppercase tracking-widest flex items-center gap-2"><i data-lucide="flame" class="w-4 h-4"></i> Mevcut Yıllık Kayıp</div><div class="text-xs text-slate-400 mt-1 font-medium" id="sumFuelLost">...</div></div><div class="text-5xl font-black text-red-600" id="sumLoss">0</div></div>
            <div class="py-6 border-b border-slate-200 flex justify-between items-center group"><div><div class="text-sm text-slate-500 font-bold uppercase tracking-widest flex items-center gap-2"><i data-lucide="wallet" class="w-4 h-4"></i> Toplam Yatırım Bedeli</div><div class="text-xs text-slate-400 mt-1">Malzeme ve İşçilik Dahil</div></div><div class="text-5xl font-black text-slate-800" id="sumInvSummary">0</div></div>
            <div class="py-6 border-b border-slate-200 flex justify-between items-center group"><div><div class="text-sm text-green-600 font-bold uppercase tracking-widest flex items-center gap-2"><i data-lucide="sprout" class="w-4 h-4"></i> Yıllık Net Kazanç</div><div class="text-xs text-slate-400 mt-1">Enerji Tasarrufu Sonrası</div></div><div class="text-5xl font-black text-green-600" id="sumNetSaveSummary">0</div></div>
            <div class="py-6 border-b border-slate-900 flex justify-between items-center group"><div><div class="text-sm text-indigo-600 font-bold uppercase tracking-widest flex items-center gap-2"><i data-lucide="timer" class="w-4 h-4"></i> Geri Dönüş Süresi (ROI)</div><div class="text-xs text-slate-400 mt-1">Amortisman</div></div><div class="text-5xl font-black text-indigo-600" id="sumRoiSummary">---</div></div>
        </div>
        <div class="mb-8"><h3 class="text-sm font-bold text-slate-900 uppercase mb-4 flex items-center gap-2"><i data-lucide="bar-chart-3" class="w-4 h-4"></i> Finansal Projeksiyon (5 Yıl)</h3><table class="w-full text-xs text-right border-collapse"><thead><tr class="bg-slate-100 text-slate-500"><th class="p-2 text-left">Senaryo</th><th class="p-2">Yıl 1</th><th class="p-2">Yıl 2</th><th class="p-2">Yıl 3</th><th class="p-2">Yıl 4</th><th class="p-2">Yıl 5</th><th class="p-2 font-black">TOPLAM</th></tr></thead><tbody class="font-mono" id="projTable"></tbody></table></div>
        <div class="flex gap-8 mb-4">
             <div class="flex-1 bg-emerald-900 rounded-xl p-6 text-white flex items-center justify-between relative overflow-hidden h-full">
                  <div class="absolute right-0 bottom-0 opacity-10 pointer-events-none translate-x-4 translate-y-4"><i data-lucide="sprout" class="w-48 h-48 text-white"></i></div>
                 <div class="z-10"><div class="text-sm text-emerald-300 font-bold uppercase tracking-widest">KARBON AYAK İZİ AZALTIMI</div><div class="text-5xl font-black mt-2"><span id="sumCo2">0</span> <span class="text-2xl font-normal text-emerald-400">Ton/Yıl</span></div></div>
                 <div class="text-right z-10 border-l border-emerald-700 pl-8"><div class="text-5xl font-black"><span id="sumTrees">0</span></div><div class="text-sm text-emerald-400 mt-1">Ağaç Eşdeğeri</div></div>
             </div>
         </div>
        <div class="border-t-2 border-slate-100 pt-4 mt-auto"><p class="text-[10px] text-slate-400 text-center font-medium leading-relaxed">Hesaplamalar ISO 12241 mühendislik standartlarına göre simüle edilmiştir. Garanti niteliği taşımaz.</p></div>
    </div>
</div>

<script src="js/data.js"></script>
<script src="js/calculator.js"></script>
<script src="js/app.js"></script>
<script src="guard.js?v=2"></script>
</body>
</html>