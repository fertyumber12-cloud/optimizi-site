<!DOCTYPE html>
<html lang="tr" class="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Optimum YalÄ±tÄ±m KalÄ±nlÄ±ÄŸÄ± Hesaplama</title>
  <meta name="description" content="VDI 2055 standartlarÄ±na gÃ¶re optimum yalÄ±tÄ±m kalÄ±nlÄ±ÄŸÄ±nÄ± hesaplayÄ±n. Enerji maliyeti ve yalÄ±tÄ±m maliyeti arasÄ±ndaki en karlÄ± dengeyi bulun.">
<meta name="keywords" content="ekonomik yalÄ±tÄ±m kalÄ±nlÄ±ÄŸÄ±, optimum izolasyon kalÄ±nlÄ±ÄŸÄ±, vdi 2055 hesabÄ±, yalÄ±tÄ±m optimizasyonu">

<meta property="og:title" content="Enerji Verimlilik SÄ±nÄ±fÄ± (Energy Class)">
<meta property="og:description" content="Ne kadar kalÄ±nlÄ±kta yalÄ±tÄ±m yapmalÄ±sÄ±nÄ±z? Enerji fiyatlarÄ±na gÃ¶re en karlÄ± yalÄ±tÄ±m kalÄ±nlÄ±ÄŸÄ±nÄ± bilimsel olarak hesaplayÄ±n.">
<meta property="og:image" content="https://www.optimizi.app/icon.jpg">
<meta property="og:url" content="https://www.optimizi.app/tool/thickness.html">
<meta property="og:type" content="article">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
<link rel="icon" type="image/jpeg" href="icon.jpg">
<link rel="icon" href="favicon.png" type="image/png">

<script>
  tailwind.config = {
    darkMode: 'class', 
    theme: {
      fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'], mono: ['"JetBrains Mono"', 'monospace'] },
      extend: {
        colors: { slate: { 850: '#151e2e', 900: '#0f172a', 950: '#020617' } },
        animation: {
            'float-slow': 'float 8s ease-in-out infinite',
            'blob': 'blob 20s infinite',
        },
        keyframes: {
            float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } },
            blob: {
                '0%': { transform: 'translate(0px, 0px) scale(1)' },
                '33%': { transform: 'translate(30px, -50px) scale(1.1)' },
                '66%': { transform: 'translate(-20px, 20px) scale(0.9)' },
                '100%': { transform: 'translate(0px, 0px) scale(1)' },
            }
        }
      }
    }
  }
</script>

<style>
  :root {
    --c-A: #348d00; --c-B: #6bb600; --c-C: #b4d600;
    --c-D: #ffd600; --c-E: #ffaa00; --c-F: #ff5500; --c-G: #d40000;
  }

  html { scroll-behavior: smooth; }
  body { 
    background: radial-gradient(ellipse at top, #1e1b4b 0%, #0f172a 40%, #020617 100%);
    background-attachment: fixed; color: #f1f5f9; overflow-x: hidden;
  }

  .glass-nav { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255,255,255,0.08); }
  .glass-card { 
      transition: all 0.3s ease;
      background-color: rgba(30, 41, 59, 0.4); 
      backdrop-filter: blur(16px); 
      border: 1px solid rgba(255, 255, 255, 0.08); 
  }

  .glass-input { 
      transition: all 0.2s; border-radius: 0.75rem; padding: 0.75rem; width: 100%; 
      background-color: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255,255,255,0.1); color: white;
      font-size: 0.875rem;
  }
  .glass-input:focus { outline: none; border-color: #6366f1; background-color: rgba(15, 23, 42, 0.8); }

  /* EiiF Chart Styles */
  .eiif-container {
    background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255,255,255,0.1);
    border-radius: 12px; padding: 15px; width: 100%;
    max-width: 380px; 
    margin-left: auto; margin-right: auto;
  }
  .eiif-headers {
    display: grid; grid-template-columns: 70px 1fr 70px; gap: 10px;
    text-align: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  .eiif-head-title { font-size: 0.65rem; font-weight: 700; color: #94a3b8; text-transform: uppercase; line-height: 1.2; }
  .eiif-row {
    display: grid; grid-template-columns: 70px 1fr 70px; gap: 10px;
    align-items: center; margin-bottom: 6px; position: relative;
  }
  .eiif-val { text-align: right; font-size: 0.75rem; color: #cbd5e1; font-family: 'JetBrains Mono', monospace; }
  .eiif-space { text-align: center; font-size: 0.75rem; color: #cbd5e1; font-family: 'JetBrains Mono', monospace; }
  
  .arrow-box {
    height: 24px; position: relative;
    clip-path: polygon(0% 0%, 90% 0%, 100% 50%, 90% 100%, 0% 100%);
    display: flex; align-items: center; padding-left: 10px;
    font-weight: 800; color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    font-family: 'Plus Jakarta Sans', sans-serif; font-size: 0.85rem;
    transition: all 0.3s ease; opacity: 0.3;
  }
  .w-a { width: 35%; background: var(--c-A); } .w-b { width: 45%; background: var(--c-B); }
  .w-c { width: 55%; background: var(--c-C); } .w-d { width: 65%; background: var(--c-D); }
  .w-e { width: 75%; background: var(--c-E); } .w-f { width: 85%; background: var(--c-F); }
  .w-g { width: 100%; background: var(--c-G); }

  .eiif-row.active .arrow-box { opacity: 1; transform: scale(1.02); box-shadow: 0 0 15px rgba(255,255,255,0.1); }
  .eiif-row.active .eiif-val, .eiif-row.active .eiif-space { color: #fff; font-weight: 800; }

  /* Marker */
  .black-marker {
    position: absolute; 
    right: 25px;
    top: 50%; transform: translateY(-50%);
    color: white; 
    display: flex; align-items: center; justify-content: center;
    text-shadow: 0 1px 3px rgba(0,0,0,0.8);
    animation: fadeIn 0.5s ease-out;
  }
  @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }

  .bg-grid { background-size: 60px 60px; background-image: linear-gradient(to right, rgba(255, 255, 255, 0.03) 1px, transparent 1px), linear-gradient(to bottom, rgba(255, 255, 255, 0.03) 1px, transparent 1px); mask-image: radial-gradient(circle at center, black 40%, transparent 80%); pointer-events: none; }
</style>
</head>
<body class="antialiased selection:bg-indigo-500/30 selection:text-white" onload="initApp()">

<div class="fixed inset-0 z-0 pointer-events-none overflow-hidden">
    <div class="absolute inset-0 bg-grid"></div>
    <div class="absolute top-0 -left-1/4 w-[900px] h-[900px] bg-indigo-600/20 rounded-full blur-[120px] animate-blob mix-blend-screen"></div>
    <div class="absolute bottom-0 -right-1/4 w-[900px] h-[900px] bg-purple-600/10 rounded-full blur-[120px] animate-blob mix-blend-screen" style="animation-delay: 5s;"></div>
</div>

<div class="relative z-10 flex flex-col min-h-screen">

    <nav class="sticky top-0 z-50 glass-card !bg-slate-900/80 !border-x-0 !border-t-0 !rounded-none border-b border-white/10 backdrop-blur-xl">
        <div class="container mx-auto px-6 h-16 flex items-center justify-between">
            <a href="../index.html" class="flex items-center gap-3 group">
                <div>
                    <h1 class="text-lg font-bold text-white tracking-wide">Optimizi<span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-orange-400">.App</span></h1>
                </div>
            </a>
            
            <div class="flex items-center gap-3">
                <button onclick="toggleLang()" class="flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 hover:bg-white/10 border border-white/10 transition text-xs text-slate-300 hover:text-white">
                    <span id="langFlag" class="text-base">ðŸ‡¹ðŸ‡·</span> <span id="langText" class="font-bold">TR</span>
                </button>
            </div>
        </div>
    </nav>

    <main class="flex-1 container mx-auto p-6 lg:p-8">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start">
            
            <div class="lg:col-span-4 space-y-6">
                
                <div class="glass-card p-6 rounded-2xl relative overflow-hidden">
                    <h3 class="text-indigo-400 text-xs font-bold uppercase mb-4 flex items-center gap-2"><i data-lucide="settings-2" class="w-4 h-4"></i> <span id="l_param">Parametreler</span></h3>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_std">Hesaplama StandardÄ±</label>
                            <select id="calcStd" class="glass-input text-xs">
                                <option value="astm">ASTM C680</option>
                                <option value="iso" selected>ISO 12241</option>
                                <option value="vdi">VDI 2055</option>
                            </select>
                        </div>

                        <div>
                            <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_equip">Ekipman Tipi</label>
                            <select id="equipType" onchange="updateUI()" class="glass-input text-xs">
                                <option value="pipe">Boru HattÄ±</option>
                                <option value="valve">Vana / ArmatÃ¼r</option>
                                <option value="flat">DÃ¼z YÃ¼zey / Tank</option>
                            </select>
                        </div>

                        <div id="rowValveType" class="hidden">
                            <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_valve">Vana Tipi</label>
                            <select id="valveType" class="glass-input text-xs">
                                <option value="gate">SÃ¼rgÃ¼lÃ¼ Vana</option>
                                <option value="globe">Globe Vana</option>
                                <option value="butterfly">Kelebek Vana</option>
                                <option value="ball">KÃ¼resel Vana</option>
                                <option value="strainer">Pislik Tutucu</option>
                                <option value="check">Ã‡ekvalf</option>
                            </select>
                        </div>

                        <div id="rowDnQty" class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_dn">Ã‡ap (DN)</label>
                                <select id="dn" class="glass-input text-xs">
                                    <option value="15">DN 15</option><option value="20">DN 20</option><option value="25">DN 25</option><option value="32">DN 32</option><option value="40">DN 40</option><option value="50">DN 50</option><option value="65">DN 65</option><option value="80">DN 80</option><option value="100" selected>DN 100</option><option value="125">DN 125</option><option value="150">DN 150</option><option value="200">DN 200</option><option value="250">DN 250</option><option value="300">DN 300</option><option value="350">DN 350</option><option value="400">DN 400</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="lblQty">Uzunluk (m)</label>
                                <input type="number" id="qty" value="1" class="glass-input text-xs">
                            </div>
                        </div>

                        <div id="rowDims" class="grid grid-cols-2 gap-4 hidden">
                            <div><label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_dimA">GeniÅŸlik (m)</label><input type="number" id="dimA" value="1" class="glass-input text-xs"></div>
                            <div><label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_dimB">YÃ¼kseklik (m)</label><input type="number" id="dimB" value="1" class="glass-input text-xs"></div>
                        </div>

                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_tin">Ä°Ã§ SÄ±caklÄ±k (Â°C)</label><div class="relative"><input type="number" id="tProc" value="250" class="glass-input text-xs pl-8"><i data-lucide="thermometer" class="w-3 h-3 text-red-400 absolute left-2.5 top-2.5"></i></div></div>
                            <div><label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_tamb">Ortam SÄ±c. (Â°C)</label><input type="number" id="tAmb" value="25" class="glass-input text-xs"></div>
                        </div>

                        <div>
                            <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_wind">RÃ¼zgar HÄ±zÄ± (m/s)</label>
                            <input type="number" id="vWind" value="1" step="0.5" min="0" class="glass-input text-xs">
                        </div>
                    </div>
                </div>

                <div class="glass-card p-6 rounded-2xl">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-white text-xs font-bold uppercase" id="tag-l1">1. KATMAN</h3>
                    </div>
                    <div class="space-y-3">
                        <div>
                            <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_mat1">Malzeme</label>
                            <select id="mat1" class="glass-input text-xs">
                                <option value="glasswool">Ä°ÄŸnelenmiÅŸ Cam Elyaf</option>
                                <option value="rockwool" selected>TaÅŸyÃ¼nÃ¼ (Sanayi)</option>
                                <option value="ceramic">Seramik Battaniye</option>
                                <option value="aerogel">Aerogel (HT650)</option>
                                <option value="rubber">Elastomerik KauÃ§uk</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_thk1">KalÄ±nlÄ±k (mm)</label>
                            <input type="number" id="thk1" value="50" class="glass-input text-xs">
                        </div>
                    </div>

                    <div class="mt-4 pt-4 border-t border-white/5">
                        <label class="flex items-center gap-3 cursor-pointer group">
                            <input type="checkbox" id="useL2" onchange="toggleL2()" class="w-4 h-4 rounded border-slate-600 bg-slate-800 text-indigo-500 focus:ring-indigo-500 focus:ring-offset-slate-900">
                            <span class="text-xs text-slate-300 group-hover:text-white transition" id="l_chkL2">2. Katman Ekle (Kompozit Sistem)</span>
                        </label>
                    </div>

                    <div id="layer2Box" class="hidden mt-4 pt-4 border-t border-white/5 space-y-3">
                        <div class="text-white text-[10px] font-bold uppercase" id="tag-l2">2. KATMAN</div>
                        <div>
                            <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_mat2">Malzeme</label>
                            <select id="mat2" class="glass-input text-xs">
                                <option value="rubber" selected>Elastomerik KauÃ§uk</option>
                                <option value="glasswool">Ä°ÄŸnelenmiÅŸ Cam Elyaf</option>
                                <option value="rockwool">TaÅŸyÃ¼nÃ¼ (Sanayi)</option>
                                <option value="aerogel">Aerogel (HT650)</option>
                                <option value="ceramic">Seramik Battaniye</option>
                            </select>
                        </div>
                        <div>
                            <label class="text-[10px] text-slate-500 font-bold uppercase mb-1 block" id="l_thk2">KalÄ±nlÄ±k (mm)</label>
                            <input type="number" id="thk2" value="19" class="glass-input text-xs">
                        </div>
                    </div>
                </div>

                <button onclick="calculate()" id="btn-calc" class="w-full bg-gradient-to-r from-indigo-600 to-indigo-500 hover:from-indigo-500 hover:to-indigo-400 text-white font-bold py-4 rounded-xl shadow-lg shadow-indigo-600/20 transition active:scale-95 text-sm tracking-wide">
                    HESAPLA
                </button>

                <div class="glass-card p-4 rounded-xl border-l-4 border-l-yellow-500/50 bg-yellow-500/5">
                    <div class="flex gap-3">
                        <i data-lucide="info" class="w-5 h-5 text-yellow-500 shrink-0 mt-0.5"></i>
                        <p class="text-[10px] text-slate-400 leading-relaxed text-justify" id="txt-legal-text">
                            Bu yazÄ±lÄ±m ISO 12241 (MÃ¼hendislik) ve EN 17956 (Tahmini SÄ±nÄ±flandÄ±rma) standartlarÄ±nÄ± kullanÄ±r. Kesin veriler iÃ§in saha Ã¶lÃ§Ã¼mÃ¼ esastÄ±r.
                        </p>
                    </div>
                </div>

            </div>

            <div class="lg:col-span-8 hidden" id="resultPanel">
                <div class="glass-card p-8 rounded-2xl h-full flex flex-col">
                    
                    <div class="eiif-container mb-8" id="eiifContainer">
                        <div class="eiif-headers">
                            <div class="eiif-head-title" id="h-flow">Max IsÄ± AkÄ±ÅŸÄ±<br>(W/m)</div>
                            <div class="eiif-head-title" id="h-class">Enerji SÄ±nÄ±fÄ±<br>(EN 17956)</div>
                            <div class="eiif-head-title" id="h-thick">Ref. KalÄ±nlÄ±k<br>(mm)</div>
                        </div>
                        <div id="eiifChartRows"></div>
                    </div>

                    <div class="text-center py-8 border-y border-white/5 mb-8">
                        <div class="text-xs text-slate-500 font-bold uppercase tracking-widest mb-2" id="res-lbl-ts">TAHMÄ°NÄ° DIÅž YÃœZEY SICAKLIÄžI</div>
                        <div class="text-6xl font-black text-white tracking-tight mb-4" id="resTs">--Â°C</div>
                        <span id="statusBadge" class="inline-flex items-center px-4 py-1 rounded-full text-xs font-bold border">GÃœVENLÄ°</span>
                    </div>

                    <div class="grid grid-cols-2 gap-6 mb-6">
                        <div class="bg-slate-900/50 p-6 rounded-xl border border-white/5 text-center">
                            <div class="text-3xl font-bold text-indigo-400 mb-1" id="resQTotal">--</div>
                            <div class="text-[10px] text-slate-500 uppercase font-bold" id="res-lbl-qtot">Toplam IsÄ± KaybÄ± (W)</div>
                        </div>
                        <div class="bg-slate-900/50 p-6 rounded-xl border border-white/5 text-center">
                            <div class="text-3xl font-bold text-indigo-400 mb-1" id="resQUnit">--</div>
                            <div class="text-[10px] text-slate-500 uppercase font-bold" id="res-lbl-qunit">Birim KayÄ±p</div>
                        </div>
                    </div>

                    <div id="rowInter" class="bg-slate-900/50 p-4 rounded-xl border border-white/5 text-center hidden mb-6">
                        <div class="text-xl font-bold text-white mb-1" id="resInter">--</div>
                        <div class="text-[10px] text-slate-500 uppercase font-bold" id="res-lbl-inter">Ara YÃ¼zey SÄ±caklÄ±ÄŸÄ± (Â°C)</div>
                    </div>

                    <div class="mt-auto hidden p-4 rounded-xl bg-red-500/10 border border-red-500/20 text-red-400 text-xs" id="alertBox">
                        <strong class="flex items-center gap-2 mb-1"><i data-lucide="alert-triangle" class="w-4 h-4"></i> <span id="res-lbl-alert">UYARI</span></strong>
                        <div id="alertMsg"></div>
                    </div>

                    <div class="mt-4 text-center">
                        <span class="text-[10px] text-slate-600">Calculation Standard: <span id="resStd" class="text-indigo-500 font-bold">ISO 12241</span> & EN 17956 Est.</span>
                        <div class="mt-2 text-[10px] font-bold text-slate-500 uppercase tracking-wide">
                            Powered by <span class="text-indigo-500">Optimizi Inc.</span>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </main>
</div>

<script>
  const t = {
    tr: {
      l_param: "Parametreler", legalText: "Bu yazÄ±lÄ±m ISO 12241 (MÃ¼hendislik) ve EN 17956 (Tahmini SÄ±nÄ±flandÄ±rma) standartlarÄ±nÄ± kullanÄ±r. Kesin veriler iÃ§in saha Ã¶lÃ§Ã¼mÃ¼ esastÄ±r.",
      l_std: "Hesaplama StandardÄ±", l_equip: "Ekipman Tipi", l_valve: "Vana Tipi", l_dn: "Ã‡ap (DN)", l_qty: "Uzunluk (m)", l_qtyValve: "Adet",
      l_dimA: "GeniÅŸlik (m)", l_dimB: "YÃ¼kseklik (m)", l_tin: "Ä°Ã§ SÄ±caklÄ±k (Â°C)", l_tamb: "Ortam SÄ±caklÄ±ÄŸÄ± (Â°C)", l_wind: "RÃ¼zgar HÄ±zÄ± (m/s)",
      l_mat: "Malzeme", l_thk: "KalÄ±nlÄ±k (mm)", l_chkL2: "2. Katman Ekle (Kompozit Sistem)", tagL1: "1. KATMAN", tagL2: "2. KATMAN", btnCalc: "HESAPLA",
      resTs: "TAHMÄ°NÄ° DIÅž YÃœZEY SICAKLIÄžI", resSafe: "GÃœVENLÄ° YÃœZEY", resDanger: "SICAK YÃœZEY DÄ°KKAT", resQTot: "Toplam IsÄ± KaybÄ± (W)", resQUnit: "Birim KayÄ±p",
      resInter: "Ara YÃ¼zey SÄ±caklÄ±ÄŸÄ± (Â°C)", resAlert: "UYARI", optPipe: "Boru HattÄ±", optValve: "Vana / ArmatÃ¼r", optFlat: "DÃ¼z YÃ¼zey / Tank",
      optGate: "SÃ¼rgÃ¼lÃ¼ Vana", optGlobe: "Globe Vana", optButterfly: "Kelebek Vana", optBall: "KÃ¼resel Vana", optStrainer: "Pislik Tutucu", optCheck: "Ã‡ekvalf",
      optGw: "Ä°ÄŸnelenmiÅŸ Cam Elyaf", optRw: "TaÅŸyÃ¼nÃ¼ (Sanayi)", optCer: "Seramik Battaniye", optAer: "Aerogel (HT650)", optRub: "Elastomerik KauÃ§uk",
      h_flow: "Max IsÄ± AkÄ±ÅŸÄ±<br>(W/m)", h_class: "Enerji SÄ±nÄ±fÄ±<br>(EN 17956)", h_thick: "Ref. KalÄ±nlÄ±k<br>(mm)", errL1: "1. Katman Limiti AÅŸÄ±ldÄ±!", errL2: "2. Katman Limiti AÅŸÄ±ldÄ±!"
    },
    en: {
      l_param: "Parameters", legalText: "This software uses ISO 12241 (Engineering) and EN 17956 (Estimated Classification) standards. Field measurement is essential for exact data.",
      l_std: "Calculation Standard", l_equip: "Equipment Type", l_valve: "Valve Type", l_dn: "Diameter (DN)", l_qty: "Length (m)", l_qtyValve: "Quantity",
      l_dimA: "Width (m)", l_dimB: "Height (m)", l_tin: "Process Temp (Â°C)", l_tamb: "Ambient Temp (Â°C)", l_wind: "Wind Speed (m/s)",
      l_mat: "Material", l_thk: "Thickness (mm)", l_chkL2: "Add 2nd Layer (Composite System)", tagL1: "1. LAYER", tagL2: "2. LAYER", btnCalc: "CALCULATE",
      resTs: "ESTIMATED SURFACE TEMP", resSafe: "SAFE SURFACE", resDanger: "HOT SURFACE WARNING", resQTot: "Total Heat Loss (W)", resQUnit: "Unit Loss",
      resInter: "Interface Temp (Â°C)", resAlert: "WARNING", optPipe: "Pipeline", optValve: "Valve / Fitting", optFlat: "Flat Surface / Tank",
      optGate: "Gate Valve", optGlobe: "Globe Valve", optButterfly: "Butterfly Valve", optBall: "Ball Valve", optStrainer: "Strainer", optCheck: "Check Valve",
      optGw: "Needled Glasswool", optRw: "Rockwool (Industrial)", optCer: "Ceramic Blanket", optAer: "Aerogel (HT650)", optRub: "Elastomeric Rubber",
      h_flow: "Max Heat Flow<br>(W/m)", h_class: "Energy Efficiency Class<br>(EN 17956)", h_thick: "Ref. Thickness<br>(mm)", errL1: "1. Layer Limit Exceeded!", errL2: "2. Layer Limit Exceeded!"
    }
  };

  let curLang = 'tr';

  // --- AUTOMATIC LANGUAGE DETECTION ---
  async function initApp() {
    try {
      const rsp = await fetch('https://ipapi.co/json/');
      const data = await rsp.json();
      if (data.country_code === 'TR') {
        setLang('tr');
      } else {
        setLang('en');
      }
    } catch (e) {
      // Fallback: Browser Language
      const userLang = navigator.language || navigator.userLanguage;
      if (userLang.startsWith('tr')) {
        setLang('tr');
      } else {
        setLang('en');
      }
    }
  }

  function toggleLang() { curLang = curLang === 'tr' ? 'en' : 'tr'; setLang(curLang); }
  function setLang(lang) {
    curLang = lang; const d = t[lang];
    document.getElementById('langFlag').innerText = lang === 'tr' ? 'ðŸ‡¹ðŸ‡·' : 'ðŸ‡¬ðŸ‡§'; document.getElementById('langText').innerText = lang === 'tr' ? 'TR' : 'EN';
    document.getElementById('l_param').innerText = d.l_param; document.getElementById('txt-legal-text').innerText = d.legalText;
    document.getElementById('l_std').innerText = d.l_std; document.getElementById('l_equip').innerText = d.l_equip; document.getElementById('l_valve').innerText = d.l_valve; document.getElementById('l_dn').innerText = d.l_dn;
    document.getElementById('l_dimA').innerText = d.l_dimA; document.getElementById('l_dimB').innerText = d.l_dimB;
    document.getElementById('l_tin').innerText = d.l_tin; document.getElementById('l_tamb').innerText = d.l_tamb; document.getElementById('l_wind').innerText = d.l_wind;
    document.getElementById('l_mat1').innerText = d.l_mat; document.getElementById('l_thk1').innerText = d.l_thk;
    document.getElementById('l_mat2').innerText = d.l_mat; document.getElementById('l_thk2').innerText = d.l_thk;
    document.getElementById('tag-l1').innerText = d.tagL1; document.getElementById('tag-l2').innerText = d.tagL2;
    document.getElementById('l_chkL2').innerText = d.l_chkL2; document.getElementById('btn-calc').innerText = d.btnCalc;
    document.getElementById('res-lbl-ts').innerText = d.resTs; document.getElementById('res-lbl-qtot').innerText = d.resQTot;
    document.getElementById('res-lbl-qunit').innerText = d.resQUnit + (document.getElementById('equipType').value === 'flat' ? " (W/mÂ²)" : " (W/m)");
    document.getElementById('res-lbl-inter').innerText = d.resInter; document.getElementById('res-lbl-alert').innerText = d.resAlert;
    document.getElementById('h-flow').innerHTML = d.h_flow; document.getElementById('h-class').innerHTML = d.h_class; document.getElementById('h-thick').innerHTML = d.h_thick;
    const badge = document.getElementById('statusBadge'); if(badge.classList.contains('bg-green-500/20')) badge.innerText = d.resSafe; else badge.innerText = d.resDanger;
    updateOpt('equipType', 'pipe', d.optPipe); updateOpt('equipType', 'valve', d.optValve); updateOpt('equipType', 'flat', d.optFlat);
    updateOpt('valveType', 'gate', d.optGate); updateOpt('valveType', 'globe', d.optGlobe); updateOpt('valveType', 'butterfly', d.optButterfly);
    updateOpt('valveType', 'ball', d.optBall); updateOpt('valveType', 'strainer', d.optStrainer); updateOpt('valveType', 'check', d.optCheck);
    ['mat1', 'mat2'].forEach(id => { updateOpt(id, 'glasswool', d.optGw); updateOpt(id, 'rockwool', d.optRw); updateOpt(id, 'ceramic', d.optCer); updateOpt(id, 'aerogel', d.optAer); updateOpt(id, 'rubber', d.optRub); });
    updateUI(); if(!document.getElementById('resultPanel').classList.contains('hidden')) { calculate(); } lucide.createIcons();
  }
  function updateOpt(id, val, txt) { const sel = document.getElementById(id); for(let o of sel.options) { if(o.value === val) o.text = txt; } }
  function updateUI() {
    const type = document.getElementById('equipType').value; const d = t[curLang];
    document.getElementById('rowValveType').classList.add('hidden'); document.getElementById('rowDnQty').classList.add('hidden'); document.getElementById('rowDims').classList.add('hidden');
    if(type === 'pipe') { document.getElementById('rowDnQty').classList.remove('hidden'); document.getElementById('rowDnQty').style.display = 'grid'; document.getElementById('lblQty').innerText = d.l_qty; }
    else if (type === 'valve') { document.getElementById('rowValveType').classList.remove('hidden'); document.getElementById('rowDnQty').classList.remove('hidden'); document.getElementById('rowDnQty').style.display = 'grid'; document.getElementById('lblQty').innerText = d.l_qtyValve; }
    else { document.getElementById('rowDims').classList.remove('hidden'); document.getElementById('rowDims').style.display = 'grid'; }
    const unitLabel = document.getElementById('res-lbl-qunit'); if(unitLabel) { unitLabel.innerText = d.resQUnit + (type === 'flat' ? " (W/mÂ²)" : " (W/m)"); }
  }
  function toggleL2() { const box = document.getElementById('layer2Box'); if(document.getElementById('useL2').checked) box.classList.remove('hidden'); else box.classList.add('hidden'); }
  const mats = { rockwool: { a: 0.035, b: 0.00017, c: 0, limit: 650 }, glasswool: { a: 0.025, b: 0.00015, c: 0, limit: 600 }, ceramic: { a: 0.025, b: 0.00012, c: 1.2e-7, limit: 1200 }, aerogel: { a: 0.019, b: 0.00004, c: 5e-8, limit: 650 }, rubber: { a: 0.034, b: 0.000075, c: 0, limit: 105 } };
  const pipeODs = { "15": 0.0213, "20": 0.0269, "25": 0.0337, "32": 0.0424, "40": 0.0483, "50": 0.0603, "65": 0.0761, "80": 0.0889, "100": 0.1143, "125": 0.1397, "150": 0.1683, "200": 0.2191, "250": 0.2730, "300": 0.3239, "350": 0.3556, "400": 0.4064 };
  const valveFactors = { gate: 1.2, globe: 1.4, butterfly: 0.6, ball: 1.0, strainer: 1.5, check: 0.9 };
  function getK(mat, T) { return mat.a + (mat.b * T) + ((mat.c || 0) * T * T); }
  function getSurfaceCoeff(std, vWind, Ts, Ta, D_out, isFlat) { const dT = Math.abs(Ts - Ta); const sigma = 5.67e-8, eps = 0.9; let h_rad = eps * sigma * (Math.pow(Ts+273.15, 4) - Math.pow(Ta+273.15, 4)) / dT; if (dT < 0.1) h_rad = 5; let h_cv = 0; if (std === 'astm') { if (vWind < 0.1) { if(isFlat) h_cv = 1.95 * Math.pow(dT, 0.25); else h_cv = 1.32 * Math.pow(dT / D_out, 0.25); } else { h_cv = 10.0 * Math.pow(vWind, 0.6) / Math.pow(D_out, 0.4); } } else if (std === 'vdi') { if (vWind < 0.1) h_cv = 3.5 + 0.05 * dT; else h_cv = 3.9 * Math.pow(vWind, 0.7) / Math.pow(D_out, 0.3); } else { if (vWind < 0.5) { if(isFlat) h_cv = 2.2 * Math.pow(dT, 0.25); else h_cv = 1.4 * Math.pow(dT/D_out, 0.25); } else { h_cv = 4 + 4 * vWind; } } if(h_cv < 1) h_cv = 1; return h_rad + h_cv; }
  function getEiifLimits(dnVal, tProc, tAmb) { const dT = tProc - tAmb; const dn = parseFloat(dnVal); const factorDN = Math.pow(dn / 100, 0.8); const factorDT = dT / 125; let limitC = 47 * factorDN * factorDT; if(limitC < 10) limitC = 10; return { A: { limit: limitC * 0.75, space: 170 }, B: { limit: limitC * 0.85, space: 130 }, C: { limit: limitC * 1.00, space: 100 }, D: { limit: limitC * 1.20, space: 80 }, E: { limit: limitC * 1.50, space: 60 }, F: { limit: limitC * 1.85, space: 40 }, G: { limit: limitC * 2.50, space: 20 } }; }
  function renderEiifChart(limits, activeClass) { const container = document.getElementById('eiifChartRows'); container.innerHTML = ''; const classes = ['A', 'B', 'C', 'D', 'E', 'F', 'G']; classes.forEach(cls => { const data = limits[cls]; const isActive = (cls === activeClass); const widthClass = `w-${cls.toLowerCase()}`; const html = `<div class="eiif-row ${isActive ? 'active' : ''}"><div class="eiif-val">${Math.round(data.limit)} W/m</div><div class="arrow-box ${widthClass}">${cls}${isActive ? `<div class="black-marker"><i data-lucide="arrow-left" class="w-3 h-3 ml-1"></i></div>` : ''}</div><div class="eiif-space">${data.space} mm</div></div>`; container.innerHTML += html; }); lucide.createIcons(); }
  function calculate() {
    const std = document.getElementById('calcStd').value; const vWind = parseFloat(document.getElementById('vWind').value); const type = document.getElementById('equipType').value; const tProc = parseFloat(document.getElementById('tProc').value); const tAmb = parseFloat(document.getElementById('tAmb').value); const useL2 = document.getElementById('useL2').checked; const d = t[curLang];
    let isFlat = (type === 'flat'); let dPipe = 0, multiplier = 1, dnVal = 100;
    if(isFlat) { const A = parseFloat(document.getElementById('dimA').value); const B = parseFloat(document.getElementById('dimB').value); multiplier = A * B; dPipe = 1.0; } else { dnVal = document.getElementById('dn').value; dPipe = pipeODs[dnVal]; const qty = parseFloat(document.getElementById('qty').value); if(type === 'valve') multiplier = valveFactors[document.getElementById('valveType').value] * qty; else multiplier = qty; }
    const m1 = mats[document.getElementById('mat1').value]; const thk1 = parseFloat(document.getElementById('thk1').value) / 1000; const m2 = useL2 ? mats[document.getElementById('mat2').value] : null; const thk2 = useL2 ? parseFloat(document.getElementById('thk2').value) / 1000 : 0;
    let minTs = tAmb, maxTs = tProc, Ts = (minTs + maxTs)/2; for(let i=0; i<100; i++) { const Tm = (tProc + Ts)/2; const k1 = getK(m1, Tm); let R1 = isFlat ? thk1/k1 : Math.log((dPipe/2 + thk1)/(dPipe/2)) / (2*Math.PI*k1); let R2 = 0; if (useL2) { const Tm2 = (Tm + Ts)/2 - 10; const k2 = getK(m2, Tm2); R2 = isFlat ? thk2/k2 : Math.log((dPipe/2 + thk1 + thk2)/(dPipe/2 + thk1)) / (2*Math.PI*k2); } const Q_cond = (tProc - Ts) / (R1 + R2); let D_out = isFlat ? 1.0 : dPipe + 2*(thk1 + thk2); const h_total = getSurfaceCoeff(std, vWind, Ts, tAmb, D_out, isFlat); let A_surf = isFlat ? 1 : 2 * Math.PI * (D_out / 2); if(Q_cond > h_total * A_surf * (Ts - tAmb)) minTs = Ts; else maxTs = Ts; Ts = (minTs + maxTs)/2; }
    const finalTs = Ts; let D_out_final = isFlat ? 1.0 : dPipe + 2*(thk1 + thk2); const h_final = getSurfaceCoeff(std, vWind, finalTs, tAmb, D_out_final, isFlat); let A_outer = isFlat ? 1 : (Math.PI * D_out_final); const Q_unit = h_final * A_outer * (finalTs - tAmb); const Q_total = Q_unit * multiplier;
    const Tm = (tProc + finalTs)/2; const k1 = getK(m1, Tm); let R1_final = isFlat ? thk1/k1 : Math.log((dPipe/2+thk1)/(dPipe/2))/(2*Math.PI*k1); const T_inter = tProc - (Q_unit * R1_final);
    const resPanel = document.getElementById('resultPanel'); resPanel.classList.remove('hidden'); resPanel.style.display = 'block';
    document.getElementById('resTs').innerText = finalTs.toFixed(1) + "Â°C"; document.getElementById('resQTotal').innerText = Math.round(Q_total).toLocaleString() + " W"; document.getElementById('resQUnit').innerText = Q_unit.toFixed(1); document.getElementById('resStd').innerText = document.getElementById('calcStd').options[document.getElementById('calcStd').selectedIndex].text;
    const badge = document.getElementById('statusBadge');
    if(finalTs < 50) { badge.className = "inline-flex items-center px-4 py-1 rounded-full text-xs font-bold border bg-green-500/20 text-green-400 border-green-500/30"; badge.innerText = d.resSafe; } else { badge.className = "inline-flex items-center px-4 py-1 rounded-full text-xs font-bold border bg-red-500/20 text-red-400 border-red-500/30"; badge.innerText = d.resDanger; }
    if(useL2) { document.getElementById('rowInter').classList.remove('hidden'); document.getElementById('resInter').innerText = T_inter.toFixed(1); } else { document.getElementById('rowInter').classList.add('hidden'); }
    const alertBox = document.getElementById('alertBox'); const alertMsg = document.getElementById('alertMsg'); let errors = [];
    if(tProc > m1.limit) errors.push(`${d.errL1} (${m1.limit}Â°C)`); if(useL2 && T_inter > m2.limit) errors.push(`${d.errL2} (${m2.limit}Â°C)`);
    if(errors.length > 0) { alertBox.style.display = 'block'; alertMsg.innerHTML = errors.join("<br>"); } else { alertBox.style.display = 'none'; }
    if(!isFlat) { document.getElementById('eiifContainer').style.display = 'block'; const limits = getEiifLimits(dnVal, tProc, tAmb); let userClass = 'G'; if(Q_unit <= limits.F.limit) userClass = 'F'; if(Q_unit <= limits.E.limit) userClass = 'E'; if(Q_unit <= limits.D.limit) userClass = 'D'; if(Q_unit <= limits.C.limit) userClass = 'C'; if(Q_unit <= limits.B.limit) userClass = 'B'; if(Q_unit <= limits.A.limit) userClass = 'A'; renderEiifChart(limits, userClass); } else { document.getElementById('eiifContainer').style.display = 'none'; }
  }
  updateUI();
</script>
</body>

</html>


