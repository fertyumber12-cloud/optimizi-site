<!doctype html>
<html lang="tr" class="dark">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Canlı Tasarruf Takibi | Optimizi.App</title>
<meta name="robots" content="noindex">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest"></script>
<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&family=JetBrains+Mono:wght@700&display=swap" rel="stylesheet">
<link rel="icon" href="favicon.png" type="image/png">

<script>
  tailwind.config = {
    darkMode: 'class',
    theme: {
      fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'], mono: ['"JetBrains Mono"', 'monospace'] },
      extend: {}
    }
  }
</script>
<style>
  /* MÜHENDİSLİK KAĞIDI ARKA PLANI & SCROLL KİLİDİ */
  body { 
      background-color: #0b1121; 
      background-image: 
          linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
          linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px),
          linear-gradient(rgba(255, 255, 255, 0.02) 1px, transparent 1px),
          linear-gradient(90deg, rgba(255, 255, 255, 0.02) 1px, transparent 1px);
      background-size: 100px 100px, 100px 100px, 20px 20px, 20px 20px;
      background-position: center center;
      color: #f1f5f9; 
      height: 100vh; 
      width: 100vw;
      display: flex; 
      flex-direction: column; 
      align-items: center;
      justify-content: center;
      overflow: hidden; 
      position: relative; 
      touch-action: none; 
  }
  
  .glass-card { 
      background-color: rgba(15, 23, 42, 0.7); 
      backdrop-filter: blur(12px); 
      border: 1px solid rgba(255, 255, 255, 0.1); 
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
      z-index: 10; 
  }
  
  .spotlight {
      position: absolute;
      top: -150px;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      height: 500px;
      background: radial-gradient(circle, rgba(56, 189, 248, 0.15) 0%, transparent 70%);
      pointer-events: none;
      z-index: 0;
  }

  .counter-text { font-variant-numeric: tabular-nums; }
</style>
</head>
<body class="antialiased font-sans">

<div class="spotlight"></div>

<main class="relative z-10 w-full max-w-md p-6 flex flex-col items-center justify-center h-full">
    
    <div class="mb-8 scale-110 flex flex-col items-center">
        <div class="flex items-center gap-3">
            <img src="icon.jpg" alt="Logo" class="w-10 h-10 rounded-xl shadow-lg shadow-indigo-500/20" onerror="this.style.display='none'">
            <h1 class="text-3xl font-black text-white tracking-tight">
                Optimizi<span class="text-green-500 animate-pulse">.App</span>
            </h1>
        </div>
        <p class="text-[10px] text-slate-400 uppercase font-bold tracking-[0.3em] mt-2 text-center text-nowrap">Energy Intelligence</p>
    </div>

    <div class="glass-card p-6 md:p-8 rounded-[2rem] w-full relative overflow-hidden border-t border-t-white/10">
        
        <div class="flex justify-between items-start mb-6">
            <div class="text-left flex-1 pr-4">
                <div class="text-[10px] text-slate-400 uppercase font-bold mb-1">Ürün / Konum</div>
                <h2 class="text-xl md:text-2xl font-black text-white leading-tight truncate" id="prdName">Yükleniyor...</h2>
                <div class="text-[10px] text-slate-500 font-mono mt-1" id="prdSerial">ID: ---</div>
            </div>
            <div class="flex items-center gap-1.5 px-3 py-1 rounded-full bg-green-500/10 border border-green-500/20 text-[10px] text-green-400 font-bold uppercase tracking-wider shrink-0">
                <span class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></span> Aktif
            </div>
        </div>
        
        <div class="text-center py-6 md:py-8 rounded-3xl bg-slate-900/60 border border-white/5 mb-6 relative group">
            <div class="text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2">Toplam Kazandırılan Tutar</div>
            <div class="flex items-baseline justify-center gap-1 flex-wrap px-2">
                <span id="liveMoney" class="font-black text-white counter-text tracking-tighter drop-shadow-[0_0_15px_rgba(56,189,248,0.2)] transition-all duration-300 text-4xl md:text-5xl">0,00</span>
                <span class="text-xl md:text-2xl font-bold text-cyan-400">₺</span>
            </div>
            <div class="text-[9px] text-slate-500 mt-2 flex items-center justify-center gap-1 opacity-70">
                <i data-lucide="info" class="w-3 h-3"></i> ISO 12241 standardına göre
            </div>
        </div>

        <div class="grid grid-cols-2 gap-3 md:gap-4 mb-6 md:mb-8">
            <div class="p-3 md:p-4 rounded-2xl bg-slate-800/30 border border-white/5 text-center">
                <div class="text-[10px] font-bold text-slate-400 uppercase mb-2 flex items-center justify-center gap-1.5">
                    <i data-lucide="leaf" class="w-3.5 h-3.5 text-green-400"></i> Karbon
                </div>
                <div class="text-base md:text-lg font-bold text-white"><span id="liveCarbon" class="counter-text">0,00</span> <span class="text-[9px] text-slate-500">Ton</span></div>
                <div class="text-[9px] text-green-400/80 mt-1 font-bold flex items-center justify-center gap-1">
                    <i data-lucide="sprout" class="w-3 h-3"></i> <span id="liveTree">0 Ağaç</span>
                </div>
            </div>

            <div class="p-3 md:p-4 rounded-2xl bg-slate-800/30 border border-white/5 text-center">
                <div class="text-[10px] font-bold text-slate-400 uppercase mb-2 flex items-center justify-center gap-1.5">
                    <i data-lucide="flame" class="w-3.5 h-3.5 text-orange-400"></i> <span id="fuelLabel">Yakıt</span>
                </div>
                <div class="text-base md:text-lg font-bold text-white"><span id="liveFuel" class="counter-text">0,00</span> <span id="fuelUnit" class="text-[9px] text-slate-500">m³</span></div>
                <div class="text-[9px] text-slate-500 mt-1">Tasarruf</div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-4 border-t border-white/5 pt-4 md:pt-6">
            <div class="font-sans text-left">
                <div class="flex items-center gap-1.5 text-[10px] text-slate-400 font-bold uppercase mb-1">
                    <i data-lucide="calendar" class="w-3 h-3 text-cyan-400"></i> Montaj Tarihi
                </div>
                <div id="installDate" class="text-xs text-white font-mono">...</div>
            </div>
            <div class="font-sans text-right">
                <div class="flex items-center justify-end gap-1.5 text-[10px] text-slate-400 font-bold uppercase mb-1">
                    Çalışma Süresi <i data-lucide="clock" class="w-3 h-3 text-orange-400"></i>
                </div>
                <div id="runTime" class="text-xs text-white font-mono">...</div>
            </div>
        </div>
        
        <div id="clientBox" class="mt-6 pt-4 border-t border-white/5 text-center hidden">
            <div class="inline-flex items-center gap-2 px-3 py-1 bg-slate-800/80 border border-white/5 rounded text-[10px] text-slate-300 font-bold uppercase tracking-wider">
                <i data-lucide="building-2" class="w-3 h-3 text-indigo-400"></i> <span id="clientName"></span>
            </div>
        </div>

    </div>
    
    <div class="mt-6 md:mt-8 opacity-60 hover:opacity-100 transition">
        <div class="flex items-center justify-center gap-2 text-[10px] text-slate-500 font-medium tracking-widest">
            <i data-lucide="shield-check" class="w-3 h-3 text-cyan-500"></i> Verified by <span class="text-slate-300 font-bold">Optimizi.App</span>
        </div>
    </div>
</main>

<script>
    lucide.createIcons();
    
    const params = new URLSearchParams(window.location.search);
    
    const config = {
        name: decodeURIComponent(params.get('p') || 'Endüstriyel Yalıtım'),
        sn: params.get('s') || 'DEMO-001',
        start: params.get('d') || new Date().toISOString().split('T')[0],
        save: parseFloat(params.get('v')) || 10000,
        fuel: params.get('f') || 'gas',
        price: parseFloat(params.get('up')) || 10.0,
        client: params.get('c') ? decodeURIComponent(params.get('c')) : null
    };

    const fuels = {
        gas:       { unit: 'm³',  co2: 0.0019, label: 'Doğalgaz' },    
        elec:      { unit: 'kWh', co2: 0.00045, label: 'Elektrik' },   
        lng:       { unit: 'kg',  co2: 0.0028, label: 'LNG' },         
        fueloil:   { unit: 'kg',  co2: 0.0031, label: 'Fuel Oil' },    
        coal_imp:  { unit: 'kg',  co2: 0.0025, label: 'İthal Kömür' }, 
        coal_loc:  { unit: 'kg',  co2: 0.0015, label: 'Yerli Kömür' },
        coal:      { unit: 'kg',  co2: 0.0025, label: 'Kömür' } 
    };

    const f = fuels[config.fuel] || fuels.gas;

    document.getElementById('prdName').innerText = config.name;
    document.getElementById('prdSerial').innerText = `ID: ${config.sn}`;
    document.getElementById('fuelUnit').innerText = f.unit;
    document.getElementById('fuelLabel').innerText = f.label;
    
    const p = config.start.split('-');
    const startDate = new Date(p[0], p[1]-1, p[2], 0, 0, 0).getTime();
    document.getElementById('installDate').innerText = new Date(startDate).toLocaleDateString('tr-TR', {day:'2-digit', month:'long', year:'numeric'});

    const savePerMs = config.save / 31536000000;

    function updateCounter() {
        const now = new Date().getTime();
        const diff = now - startDate;

        if (diff > 0) {
            const money = diff * savePerMs;
            const unitPrice = config.price > 0 ? config.price : 1; 
            const fuelAmount = money / unitPrice;
            const co2Ton = fuelAmount * f.co2;
            const trees = co2Ton / 0.025;

            const moneyStr = money.toLocaleString('tr-TR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            const moneyEl = document.getElementById('liveMoney');
            moneyEl.innerText = moneyStr;

            // Auto-Scale Font (Mobil uyumlu boyutlar)
            const len = moneyStr.length;
            if(len > 13) {
                moneyEl.className = "font-black text-white counter-text tracking-tighter drop-shadow-[0_0_15px_rgba(56,189,248,0.2)] transition-all duration-300 text-2xl md:text-3xl"; 
            } else if (len > 10) {
                moneyEl.className = "font-black text-white counter-text tracking-tighter drop-shadow-[0_0_15px_rgba(56,189,248,0.2)] transition-all duration-300 text-3xl md:text-4xl"; 
            } else {
                moneyEl.className = "font-black text-white counter-text tracking-tighter drop-shadow-[0_0_15px_rgba(56,189,248,0.2)] transition-all duration-300 text-4xl md:text-5xl"; 
            }

            document.getElementById('liveFuel').innerText = fuelAmount.toLocaleString('tr-TR', { minimumFractionDigits: 1, maximumFractionDigits: 1 });
            document.getElementById('liveCarbon').innerText = co2Ton.toLocaleString('tr-TR', { minimumFractionDigits: 3, maximumFractionDigits: 3 });
            document.getElementById('liveTree').innerText = `${Math.floor(trees)} Ağaç`;

            const d = Math.floor(diff/86400000);
            const h = Math.floor((diff/3600000)%24);
            const m = Math.floor((diff/60000)%60);
            const s = Math.floor((diff/1000)%60);
            
            let timeStr = "";
            if(d > 0) timeStr = `${d} Gün ${h} Saat`;
            else timeStr = `${h} Saat ${m} Dakika`;
            
            document.getElementById('runTime').innerHTML = `${timeStr} <span class="opacity-30 text-[9px]">(${s}sn)</span>`;
        } else {
            document.getElementById('runTime').innerText = "Başlıyor...";
        }
        
        requestAnimationFrame(updateCounter);
    }

    updateCounter();
</script>
</body>
</html>
